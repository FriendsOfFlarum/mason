module.exports=function(t){var e={};function n(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=28)}([function(t,e){t.exports=flarum.core.compat.app},function(t,e){t.exports=flarum.core.compat.Model},function(t,e,n){"use strict";function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}n.d(e,"a",function(){return a})},function(t,e){t.exports=flarum.core.compat.Component},function(t,e){t.exports=flarum.core.compat.extend},function(t,e){t.exports=flarum.core.compat["helpers/icon"]},function(t,e){t.exports=flarum.core.compat["components/Button"]},function(t,e,n){"use strict";e.a=function(t,e){return void 0===e&&(e="sort"),t.sort(function(t,n){return t[e]()-n[e]()})}},function(t,e){t.exports=flarum.core.compat["components/Switch"]},function(t,e){t.exports=flarum.core.compat["utils/mixin"]},function(t,e){t.exports=flarum.core.compat["utils/ItemList"]},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var a=n(2),o=(n(0),n(1)),r=n.n(o),i=n(9),s=function(t){function e(){return t.apply(this,arguments)||this}return Object(a.a)(e,t),e.prototype.apiEndpoint=function(){return"/flagrow/mason/answers"+(this.exists?"/"+this.data.id:"")},e}(n.n(i)()(r.a,{content:r.a.attribute("content"),is_suggested:r.a.attribute("is_suggested"),sort:r.a.attribute("sort"),field:r.a.hasOne("field")}))},function(t,e){t.exports=flarum.core.compat["utils/computed"]},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var a=n(2),o=(n(0),n(1)),r=n.n(o),i=n(9),s=n.n(i),l=n(12),d=n.n(l),u=function(t){function e(){return t.apply(this,arguments)||this}return Object(a.a)(e,t),e.prototype.apiEndpoint=function(){return"/flagrow/mason/fields"+(this.exists?"/"+this.data.id:"")},e}(s()(r.a,{name:r.a.attribute("name"),description:r.a.attribute("description"),min_answers_count:r.a.attribute("min_answers_count"),max_answers_count:r.a.attribute("max_answers_count"),show_when_empty:r.a.attribute("show_when_empty"),user_values_allowed:r.a.attribute("user_values_allowed"),validation:r.a.attribute("validation"),icon:r.a.attribute("icon"),sort:r.a.attribute("sort"),deleted_at:r.a.attribute("deleted_at",r.a.transformDate),all_answers:r.a.hasMany("all_answers"),suggested_answers:r.a.hasMany("suggested_answers"),required:d()("min_answers_count",function(t){return t>0}),multiple:d()("max_answers_count",function(t){return t>1})}))},,,,,,,,,function(t,e){t.exports=flarum.core.compat["components/AdminNav"]},function(t,e){t.exports=flarum.core.compat["components/AdminLinkButton"]},function(t,e){t.exports=flarum.core.compat["utils/saveSettings"]},function(t,e){t.exports=flarum.core.compat["components/Select"]},function(t,e){t.exports=flarum.core.compat["components/PermissionGrid"]},,function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),r=n(11),i=n(13),s=n(4),l=n(22),d=n.n(l),u=n(23),c=n.n(u),f=n(2),p=n(3),h=n.n(p),g=n(5),w=n.n(g),v=n(6),b=n.n(v),y=n(8),_=n.n(y),E=function(t){function e(){return t.apply(this,arguments)||this}Object(f.a)(e,t);var n=e.prototype;return n.init=function(){this.answer=this.props.answer,this.dirty=!1,this.processing=!1},n.view=function(){var t=this;return m("form.Mason-Box",[this.answer.is_suggested()?[m("span.fa.fa-arrows-alt-v.Mason-Box--handle.js-answer-handle")," "]:null,m("span",{onclick:function(){var e=prompt("Edit content",t.answer.content());e&&t.updateAttribute("content",e)}},[this.answer.content()," ",w()("fas fa-pen")]),_.a.component({state:this.answer.is_suggested(),onchange:function(e){t.updateAttribute("is_suggested",e),t.saveAnswer()},children:o.a.translator.trans("flagrow-mason.admin.fields.is_suggested")}),m(".ButtonGroup",[b.a.component({type:"submit",className:"Button Button--primary",children:o.a.translator.trans("flagrow-mason.admin.buttons.save-answer"),loading:this.processing,disabled:!this.readyToSave(),onclick:this.saveAnswer.bind(this)}),b.a.component({type:"submit",className:"Button Button--danger",children:o.a.translator.trans("flagrow-mason.admin.buttons.delete-answer"),loading:this.processing,onclick:this.deleteAnswer.bind(this)})])])},n.updateAttribute=function(t,e){var n;this.answer.pushAttributes(((n={})[t]=e,n)),this.dirty=!0},n.readyToSave=function(){return this.dirty},n.saveAnswer=function(){var t=this;this.processing=!0,this.answer.save(this.answer.data.attributes).then(function(){t.processing=!1,t.dirty=!1,m.redraw()}).catch(function(e){throw t.processing=!1,e})},n.deleteAnswer=function(){var t=this;confirm(o.a.translator.trans("flagrow-mason.admin.messages.delete-answer-confirmation",{content:this.answer.content()}))&&(this.processing=!0,this.answer.delete().then(function(){t.processing=!1,m.redraw()}).catch(function(e){throw t.processing=!1,e}))},e}(h.a);function x(t,e,n){if(void 0===n)return t&&t.h5s&&t.h5s.data&&t.h5s.data[e];t.h5s=t.h5s||{},t.h5s.data=t.h5s.data||{},t.h5s.data[e]=n}var T=function(t,e){if(!(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array))throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.");return"string"!=typeof e?Array.from(t):Array.from(t).filter(function(t){return 1===t.nodeType&&t.matches(e)})},A=new Map,F=function(){function t(){this._config=new Map,this._placeholder=void 0,this._data=new Map}return Object.defineProperty(t.prototype,"config",{get:function(){var t={};return this._config.forEach(function(e,n){t[n]=e}),t},set:function(t){if("object"!=typeof t)throw new Error("You must provide a valid configuration object to the config setter.");var e=Object.assign({},t);this._config=new Map(Object.entries(e))},enumerable:!0,configurable:!0}),t.prototype.setConfig=function(t,e){if(!this._config.has(t))throw new Error("Trying to set invalid configuration item: "+t);this._config.set(t,e)},t.prototype.getConfig=function(t){if(!this._config.has(t))throw new Error("Invalid configuration item requested: "+t);return this._config.get(t)},Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._placeholder},set:function(t){if(!(t instanceof HTMLElement)&&null!==t)throw new Error("A placeholder must be an html element or null.");this._placeholder=t},enumerable:!0,configurable:!0}),t.prototype.setData=function(t,e){if("string"!=typeof t)throw new Error("The key must be a string.");this._data.set(t,e)},t.prototype.getData=function(t){if("string"!=typeof t)throw new Error("The key must be a string.");return this._data.get(t)},t.prototype.deleteData=function(t){if("string"!=typeof t)throw new Error("The key must be a string.");return this._data.delete(t)},t}(),S=function(t){if(!(t instanceof HTMLElement))throw new Error("Please provide a sortable to the store function.");return A.has(t)||A.set(t,new F),A.get(t)};function M(t,e,n){if(t instanceof Array)for(var a=0;a<t.length;++a)M(t[a],e,n);else t.addEventListener(e,n),S(t).setData("event"+e,n)}function C(t,e){if(t instanceof Array)for(var n=0;n<t.length;++n)C(t[n],e);else t.removeEventListener(e,S(t).getData("event"+e)),S(t).deleteData("event"+e)}function O(t,e,n){if(t instanceof Array)for(var a=0;a<t.length;++a)O(t[a],e,n);else t.setAttribute(e,n)}function L(t,e){if(t instanceof Array)for(var n=0;n<t.length;++n)L(t[n],e);else t.removeAttribute(e)}var j=function(t){if(!t.parentElement||0===t.getClientRects().length)throw new Error("target element must be part of the dom");var e=t.getClientRects()[0];return{left:e.left+window.pageXOffset,right:e.right+window.pageXOffset,top:e.top+window.pageYOffset,bottom:e.bottom+window.pageYOffset}},H=function(t,e){var n;return void 0===e&&(e=0),function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];clearTimeout(n),n=setTimeout(function(){t.apply(void 0,a)},e)}},B=function(t,e){if(!(t instanceof HTMLElement&&(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array)))throw new Error("You must provide an element and a list of elements.");return Array.from(e).indexOf(t)},I=function(t){if(!(t instanceof HTMLElement))throw new Error("Element is not a node element.");return null!==t.parentNode},P=function(t,e,n){if(!(t instanceof HTMLElement&&t.parentElement instanceof HTMLElement))throw new Error("target and element must be a node");t.parentElement.insertBefore(e,"before"===n?t:t.nextElementSibling)},D=function(t,e){return P(t,e,"before")},k=function(t,e){return P(t,e,"after")},N=function(t,e,n){if(void 0===e&&(e=function(t,e){return t}),void 0===n&&(n=function(t){return t}),!(t instanceof HTMLElement)||!0==!t.isSortable)throw new Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof e||"function"!=typeof n)throw new Error("You need to provide a valid serializer for items and the container.");var a=x(t,"opts").items,o=T(t.children,a),r=o.map(function(e){return{parent:t,node:e,html:e.outerHTML,index:B(e,o)}});return{container:n({node:t,itemCount:r.length}),items:r.map(function(n){return e(n,t)})}},Y=function(t,e,n){var a;if(void 0===n&&(n="sortable-placeholder"),!(t instanceof HTMLElement))throw new Error("You must provide a valid element as a sortable.");if(!(e instanceof HTMLElement)&&void 0!==e)throw new Error("You must provide a valid element as a placeholder or set ot to undefined.");return void 0===e&&(["UL","OL"].includes(t.tagName)?e=document.createElement("li"):["TABLE","TBODY"].includes(t.tagName)?(e=document.createElement("tr")).innerHTML='<td colspan="100"></td>':e=document.createElement("div")),"string"==typeof n&&(a=e.classList).add.apply(a,n.split(" ")),e},q=function(t){if(!(t instanceof HTMLElement))throw new Error("You must provide a valid dom element");var e=window.getComputedStyle(t);return["height","padding-top","padding-bottom"].map(function(t){var n=parseInt(e.getPropertyValue(t),10);return isNaN(n)?0:n}).reduce(function(t,e){return t+e})},U=function(t){if(!(t instanceof HTMLElement))throw new Error("You must provide a valid dom element");var e=window.getComputedStyle(t);return["width","padding-left","padding-right"].map(function(t){var n=parseInt(e.getPropertyValue(t),10);return isNaN(n)?0:n}).reduce(function(t,e){return t+e})},z=function(t,e){if(!(t instanceof Array))throw new Error("You must provide a Array of HTMLElements to be filtered.");return"string"!=typeof e?t:t.filter(function(t){return t.querySelector(e)instanceof HTMLElement||t.shadowRoot&&t.shadowRoot.querySelector(e)instanceof HTMLElement}).map(function(t){return t.querySelector(e)||t.shadowRoot&&t.shadowRoot.querySelector(e)})},W=function(t){return t.composedPath&&t.composedPath()[0]||t.target},R=function(t,e,n){return{element:t,posX:n.pageX-e.left,posY:n.pageY-e.top}},X=function(t,e,n){if(!(t instanceof Event))throw new Error("setDragImage requires a DragEvent as the first argument.");if(!(e instanceof HTMLElement))throw new Error("setDragImage requires the dragged element as the second argument.");if(n||(n=R),t.dataTransfer&&t.dataTransfer.setDragImage){var a=n(e,j(e),t);if(!(a.element instanceof HTMLElement)||"number"!=typeof a.posX||"number"!=typeof a.posY)throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setData("text/plain",W(t).id),t.dataTransfer.setDragImage(a.element,a.posX,a.posY)}},G=function(t,e){if(!0===t.isSortable){var n=S(t).getConfig("acceptFrom");if(null!==n&&!1!==n&&"string"!=typeof n)throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==n)return!1!==n&&n.split(",").filter(function(t){return t.length>0&&e.matches(t)}).length>0;if(t===e)return!0;if(void 0!==S(t).getConfig("connectWith")&&null!==S(t).getConfig("connectWith"))return S(t).getConfig("connectWith")===S(e).getConfig("connectWith")}return!1},V={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"};var J,K,Q,Z,tt,et,nt,at,ot,rt=function(t,e){if("string"==typeof S(t).getConfig("hoverClass")){var n=S(t).getConfig("hoverClass").split(" ");!0===e?(M(t,"mousemove",function(t,e){var n=this;if(void 0===e&&(e=250),"function"!=typeof t)throw new Error("You must provide a function as the first argument for throttle.");if("number"!=typeof e)throw new Error("You must provide a number as the second argument for throttle.");var a=null;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];var i=Date.now();(null===a||i-a>=e)&&(a=i,t.apply(n,o))}}(function(e){0===e.buttons&&T(t.children,S(t).getConfig("items")).forEach(function(t){var a,o;t!==e.target?(a=t.classList).remove.apply(a,n):(o=t.classList).add.apply(o,n)})},S(t).getConfig("throttleTime"))),M(t,"mouseleave",function(){T(t.children,S(t).getConfig("items")).forEach(function(t){var e;(e=t.classList).remove.apply(e,n)})})):(C(t,"mousemove"),C(t,"mouseleave"))}},it=function(t){C(t,"dragstart"),C(t,"dragend"),C(t,"dragover"),C(t,"dragenter"),C(t,"drop"),C(t,"mouseenter"),C(t,"mouseleave")},st=function(t,e){var n=t;return!0===S(e).getConfig("copy")&&(O(n=t.cloneNode(!0),"aria-copied","true"),t.parentElement.appendChild(n),n.style.display="none",n.oldDisplay=t.style.display),n},lt=function(t){var e;(e=t).h5s&&delete e.h5s.data,L(t,"aria-dropeffect")},dt=function(t){L(t,"aria-grabbed"),L(t,"aria-copied"),L(t,"draggable"),L(t,"role")};function ut(t,e){if(e.composedPath)return e.composedPath().find(function(t){return t.isSortable});for(;!0!==t.isSortable;)t=t.parentElement;return t}function ct(t,e){var n=x(t,"opts"),a=T(t.children,n.items).filter(function(t){return t.contains(e)||t.shadowRoot&&t.shadowRoot.contains(e)});return a.length>0?a[0]:e}var ft=function(t){var e=x(t,"opts"),n=T(t.children,e.items),a=z(n,e.handle);(O(t,"aria-dropeffect","move"),x(t,"_disabled","false"),O(a,"draggable","true"),!1===e.disableIEFix)&&("function"==typeof(document||window.document).createElement("span").dragDrop&&M(a,"mousedown",function(){if(-1!==n.indexOf(this))this.dragDrop();else{for(var t=this.parentElement;-1===n.indexOf(t);)t=t.parentElement;t.dragDrop()}}))},mt=function(t){var e=x(t,"opts"),n=T(t.children,e.items),a=z(n,e.handle);x(t,"_disabled","false"),it(n),C(a,"mousedown"),C(t,"dragover"),C(t,"dragenter"),C(t,"drop")};function pt(t,e){var n=String(e);return e=e||{},"string"==typeof t&&(t=document.querySelectorAll(t)),t instanceof HTMLElement&&(t=[t]),t=Array.prototype.slice.call(t),/serialize/.test(n)?t.map(function(t){var e=x(t,"opts");return N(t,e.itemSerializer,e.containerSerializer)}):(t.forEach(function(t){if(/enable|disable|destroy/.test(n))return pt[n](t);["connectWith","disableIEFix"].forEach(function(t){Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+t+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')}),e=Object.assign({},V,S(t).config,e),S(t).config=e,x(t,"opts",e),t.isSortable=!0,mt(t);var a,o=T(t.children,e.items);if(null!==e.placeholder&&void 0!==e.placeholder){var r=document.createElement(t.tagName);e.placeholder instanceof HTMLElement?r.appendChild(e.placeholder):r.innerHTML=e.placeholder,a=r.children[0]}S(t).placeholder=Y(t,a,e.placeholderClass),x(t,"items",e.items),e.acceptFrom?x(t,"acceptFrom",e.acceptFrom):e.connectWith&&x(t,"connectWith",e.connectWith),ft(t),O(o,"role","option"),O(o,"aria-grabbed","false"),rt(t,!0),M(t,"dragstart",function(t){var n=W(t);if(!0!==n.isSortable&&(t.stopImmediatePropagation(),(!e.handle||n.matches(e.handle))&&"false"!==n.getAttribute("draggable"))){var a=ut(n,t),o=ct(a,n);nt=T(a.children,e.items),tt=nt.indexOf(o),et=B(o,a.children),Z=a,X(t,o,e.customDragImage),K=q(o),Q=U(o),o.classList.add(e.draggingClass),O(J=st(o,a),"aria-grabbed","true"),a.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:et,index:tt,container:Z},item:J,originalTarget:n}}))}}),M(t,"dragenter",function(e){var n=W(e),a=ut(n,e);a&&a!==at&&(ot=T(a.children,x(a,"items")).filter(function(e){return e!==S(t).placeholder}),a.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:et,index:tt,container:Z},destination:{container:a,itemsBeforeUpdate:ot},item:J,originalTarget:n}}))),at=a}),M(t,"dragend",function(n){if(J){J.classList.remove(e.draggingClass),O(J,"aria-grabbed","false"),"true"===J.getAttribute("aria-copied")&&"true"!==x(J,"dropped")&&J.remove(),J.style.display=J.oldDisplay,delete J.oldDisplay;var a=Array.from(A.values()).map(function(t){return t.placeholder}).filter(function(t){return t instanceof HTMLElement}).filter(I)[0];a&&a.remove(),t.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:et,index:tt,container:Z},item:J}})),at=null,J=null,K=null,Q=null}}),M(t,"drop",function(n){if(G(t,J.parentElement)){n.preventDefault(),n.stopPropagation(),x(J,"dropped","true");var a=Array.from(A.values()).map(function(t){return t.placeholder}).filter(function(t){return t instanceof HTMLElement}).filter(I)[0];k(a,J),a.remove(),t.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:et,index:tt,container:Z},item:J}}));var o=S(t).placeholder,r=T(Z.children,e.items).filter(function(t){return t!==o}),i=!0===this.isSortable?this:this.parentElement,s=T(i.children,x(i,"items")).filter(function(t){return t!==o}),l=B(J,Array.from(J.parentElement.children).filter(function(t){return t!==o})),d=B(J,s);et===l&&Z===i||t.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:et,index:tt,container:Z,itemsBeforeUpdate:nt,items:r},destination:{index:d,elementIndex:l,container:i,itemsBeforeUpdate:ot,items:s},item:J}}))}});var i=H(function(t,n,a,o){if(J)if(e.forcePlaceholderSize&&(S(t).placeholder.style.height=K+"px",S(t).placeholder.style.width=Q+"px"),Array.from(t.children).indexOf(n)>-1){var r=q(n),i=U(n),s=B(S(t).placeholder,n.parentElement.children),l=B(n,n.parentElement.children);if(r>K||i>Q){var d=r-K,u=i-Q,c=j(n).top,f=j(n).left;if(s<l&&("vertical"===e.orientation&&o<c||"horizontal"===e.orientation&&a<f))return;if(s>l&&("vertical"===e.orientation&&o>c+r-d||"horizontal"===e.orientation&&a>f+i-u))return}void 0===J.oldDisplay&&(J.oldDisplay=J.style.display),"none"!==J.style.display&&(J.style.display="none");var m=!1;try{var p=j(n).top+n.offsetHeight/2,h=j(n).left+n.offsetWidth/2;m="vertical"===e.orientation&&o>=p||"horizontal"===e.orientation&&a>=h}catch(t){m=s<l}m?k(n,S(t).placeholder):D(n,S(t).placeholder),Array.from(A.values()).filter(function(t){return void 0!==t.placeholder}).forEach(function(e){e.placeholder!==S(t).placeholder&&e.placeholder.remove()})}else{var g=Array.from(A.values()).filter(function(t){return void 0!==t.placeholder}).map(function(t){return t.placeholder});-1!==g.indexOf(n)||t!==n||T(n.children,e.items).length||(g.forEach(function(t){return t.remove()}),n.appendChild(S(t).placeholder))}},e.debounce),s=function(t){var e=t.target,n=!0===e.isSortable?e:ut(e,t);if(e=ct(n,e),J&&G(n,J.parentElement)&&"true"!==x(n,"_disabled")){var a=x(n,"opts");parseInt(a.maxItems)&&T(n.children,x(n,"items")).length>=parseInt(a.maxItems)&&J.parentElement!==n||(t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect=!0===S(n).getConfig("copy")?"copy":"move",i(n,e,t.pageX,t.pageY))}};M(o.concat(t),"dragover",s),M(o.concat(t),"dragenter",s)}),t)}pt.destroy=function(t){!function(t){var e=x(t,"opts")||{},n=T(t.children,e.items),a=z(n,e.handle);C(t,"dragover"),C(t,"dragenter"),C(t,"dragstart"),C(t,"dragend"),C(t,"drop"),lt(t),C(a,"mousedown"),it(n),dt(n),t.isSortable=!1}(t)},pt.enable=function(t){ft(t)},pt.disable=function(t){!function(t){var e=x(t,"opts"),n=T(t.children,e.items),a=z(n,e.handle);O(t,"aria-dropeffect","none"),x(t,"_disabled","true"),O(a,"draggable","false"),C(a,"mousedown")}(t)},pt.__testing={_data:x,_removeItemEvents:it,_removeItemData:dt,_removeSortableData:lt};var ht=pt,gt=n(7),wt=function(t){function e(){return t.apply(this,arguments)||this}Object(f.a)(e,t);var n=e.prototype;return n.init=function(){this.field=this.props.field,this.processing=!1,this.new_content="",this.showUserAnswers=!1},n.config=function(){var t=this;ht(".js-answers-container",{handle:".js-answers-handle",items:".js-answers-data"}).forEach(function(e){$(e).off("sortupdate").on("sortupdate",function(e){var n=e.detail.destination.items.map(function(t){return $(t).data("id")});t.updateSort(n)})})},n.view=function(){var t=this;if(!this.field.exists)return m("div",o.a.translator.trans("flagrow-mason.admin.fields.save-field-for-answers"));var e=[],n=[];return this.field.all_answers().forEach(function(t){void 0!==t&&(t.is_suggested()?e.push(t):n.push(t))}),m("div",[m(".Mason-Container.js-answers-container",Object(gt.a)(e).map(function(t){return m(".js-answer-data",{key:t.id(),"data-id":t.id()},E.component({answer:t}))})),n.length?[m(".Button.Button--block.Mason-Box-Header",{onclick:function(){t.showUserAnswers=!t.showUserAnswers}},[m(".Mason-Box-Header-Title",o.a.translator.trans("flagrow-mason.admin.buttons.show-user-answers",{count:n.length})),m("div",[w()("fas fa-chevron-"+(this.showUserAnswers?"up":"down"))])]),this.showUserAnswers?m(".Mason-Container",Object(gt.a)(n,"content").map(function(t){return m("div",{key:t.id()},E.component({answer:t}))})):null]:null,m("form",[m(".Form-group",[m("label","New answer"),m("input.FormControl",{value:this.new_content,oninput:m.withAttr("value",function(e){t.new_content=e}),placeholder:o.a.translator.trans("flagrow-mason.admin.fields.new-answer-placeholder")})]),m(".Form-group",[b.a.component({type:"submit",className:"Button Button--primary",children:o.a.translator.trans("flagrow-mason.admin.buttons.add-answer"),loading:this.processing,disabled:!this.new_content,onclick:this.saveField.bind(this)})])])])},n.saveField=function(){var t=this;this.processing=!0,o.a.request({method:"POST",url:o.a.forum.attribute("apiUrl")+this.field.apiEndpoint()+"/answers",data:{data:{attributes:{content:this.new_content,is_suggested:!0}}}}).then(function(e){o.a.store.pushPayload(e),t.new_content="",t.processing=!1,m.redraw()})},n.updateSort=function(t){o.a.request({method:"POST",url:o.a.forum.attribute("apiUrl")+this.field.apiEndpoint()+"/answers/order",data:{sort:t}}).then(function(t){o.a.store.pushPayload(t),m.redraw()})},e}(h.a),vt=function(t){function e(){return t.apply(this,arguments)||this}Object(f.a)(e,t);var n=e.prototype;return n.init=function(){this.field=this.props.field,this.dirty=!1,this.processing=!1,this.toggleFields=!1,null===this.field&&this.initNewField()},n.initNewField=function(){this.field=o.a.store.createRecord("flagrow-mason-field",{attributes:{name:"",description:"",min_answers_count:0,max_answers_count:1,user_values_allowed:!1,show_when_empty:!1,validation:"",icon:""}})},n.boxTitle=function(){return this.field.exists?this.field.name():o.a.translator.trans("flagrow-mason.admin.buttons.new-field")},n.view=function(){var t=this;return m(".Mason-Box",[this.field.exists?m("span.fa.fa-arrows-alt-v.Mason-Box--handle.js-field-handle"):null,m(".Button.Button--block.Mason-Box-Header",{onclick:function(){t.toggleFields=!t.toggleFields}},[m(".Mason-Box-Header-Title",this.boxTitle()),m("div",[this.field.exists?[o.a.translator.trans("flagrow-mason.admin.buttons.edit-field")," "]:null,w()("fas fa-chevron-"+(this.toggleFields?"up":"down"))])]),this.toggleFields?this.viewFields():null])},n.viewFields=function(){var t=this;return m("form",[m(".Mason-Box--row",[m(".Mason-Box--column",[m("h4","Field settings"),m(".Form-group",[m("label",o.a.translator.trans("flagrow-mason.admin.fields.name")),m("input.FormControl",{value:this.field.name(),oninput:m.withAttr("value",this.updateAttribute.bind(this,"name"))}),m(".helpText",o.a.translator.trans("flagrow-mason.admin.fields.name-help"))]),m(".Form-group",[m("label",o.a.translator.trans("flagrow-mason.admin.fields.description")),m("input.FormControl",{value:this.field.description(),oninput:m.withAttr("value",this.updateAttribute.bind(this,"description"))}),m(".helpText",o.a.translator.trans("flagrow-mason.admin.fields.description-help"))]),m(".Form-group",[m("label",[_.a.component({state:1===this.field.min_answers_count(),onchange:function(e){t.updateAttribute("min_answers_count",e?1:0)},children:o.a.translator.trans("flagrow-mason.admin.fields.required")})])]),m(".Form-group",[m("label",[_.a.component({state:this.field.show_when_empty(),onchange:this.updateAttribute.bind(this,"show_when_empty"),children:o.a.translator.trans("flagrow-mason.admin.fields.show_when_empty")})]),m(".helpText",o.a.translator.trans("flagrow-mason.admin.fields.show_when_empty-help"))]),m(".Form-group",[m("label",[_.a.component({state:this.field.user_values_allowed(),onchange:this.updateAttribute.bind(this,"user_values_allowed"),children:o.a.translator.trans("flagrow-mason.admin.fields.user_values_allowed")})]),m(".helpText",o.a.translator.trans("flagrow-mason.admin.fields.user_values_allowed-help"))]),m(".Form-group",[m("label",o.a.translator.trans("flagrow-mason.admin.fields.validation")),m("input.FormControl",{disabled:!this.field.user_values_allowed(),placeholder:this.field.user_values_allowed()?"":o.a.translator.trans("flagrow-mason.admin.fields.enable-user-values-for-validation"),value:this.field.validation(),oninput:m.withAttr("value",this.updateAttribute.bind(this,"validation"))}),m(".helpText",o.a.translator.trans("flagrow-mason.admin.fields.validation-help",{a:m("a[href=https://laravel.com/docs/5.1/validation#available-validation-rules][_target=blank]")}))]),m(".Form-group",[m("label",[o.a.translator.trans("flagrow-mason.admin.fields.icon"),this.iconPreview(this.field.icon())]),m("input.FormControl",{value:this.field.icon(),oninput:m.withAttr("value",this.updateAttribute.bind(this,"icon"))}),m(".helpText",o.a.translator.trans("flagrow-mason.admin.fields.icon-help",{a:m("a[href=https://fontawesome.com/icons?m=free][_target=blank]")}))])]),m(".Mason-Box--column",[m("h4","Field answers"),m(".Form-group",wt.component({field:this.field}))])]),m("li.ButtonGroup",[b.a.component({type:"submit",className:"Button Button--primary",children:o.a.translator.trans("flagrow-mason.admin.buttons."+(this.field.exists?"save":"add")+"-field"),loading:this.processing,disabled:!this.readyToSave(),onclick:this.saveField.bind(this)}),this.field.exists?b.a.component({type:"submit",className:"Button Button--danger",children:o.a.translator.trans("flagrow-mason.admin.buttons.delete-field"),loading:this.processing,onclick:this.deleteField.bind(this)}):""])])},n.updateAttribute=function(t,e){var n;this.field.pushAttributes(((n={})[t]=e,n)),this.dirty=!0},n.readyToSave=function(){return this.dirty},n.saveField=function(){var t=this;this.processing=!0;var e=!this.field.exists;this.field.save(this.field.data.attributes).then(function(){e&&(t.initNewField(),t.toggleFields=!1),t.processing=!1,t.dirty=!1,m.redraw()}).catch(function(e){throw t.processing=!1,e})},n.deleteField=function(){var t=this;confirm(o.a.translator.trans("flagrow-mason.admin.messages.delete-field-confirmation",{name:this.field.name()}))&&(this.processing=!0,this.field.delete().then(function(){t.processing=!1,m.redraw()}).catch(function(e){throw t.processing=!1,e}))},n.iconPreview=function(t){return t?[" (",o.a.translator.trans("flagrow-mason.admin.fields.icon-preview",{preview:w()(t)}),")"]:""},e}(h.a),bt=n(24),yt=n.n(bt),_t=n(25),Et=n.n(_t),xt=function(t){function e(){return t.apply(this,arguments)||this}Object(f.a)(e,t);var n=e.prototype;return n.init=function(){this.fieldsSectionTitle=m.prop(o.a.data.settings["flagrow.mason.fields-section-title"]||""),this.columnCount=m.prop(o.a.data.settings["flagrow.mason.column-count"]||1),this.labelsAsPlaceholders=m.prop(o.a.data.settings["flagrow.mason.labels-as-placeholders"]>0),this.fieldsInHero=m.prop(o.a.data.settings["flagrow.mason.fields-in-hero"]>0),this.hideEmptyFieldsSection=m.prop(o.a.data.settings["flagrow.mason.hide-empty-fields-section"]>0),this.tagsAsFields=m.prop(o.a.data.settings["flagrow.mason.tags-as-fields"]>0),this.tagsFieldName=m.prop(o.a.data.settings["flagrow.mason.tags-field-name"]||""),this.columnOptions={};for(var t=1;t<=3;t++)this.columnOptions[t]=o.a.translator.trans("flagrow-mason.admin.settings.n-columns",{count:t})},n.view=function(){return m(".Mason-Container",[m(".Form-group",[m("label",o.a.translator.trans("flagrow-mason.admin.settings.fields-section-title")),m("input.FormControl",{value:this.fieldsSectionTitle(),placeholder:o.a.translator.trans("flagrow-mason.admin.settings.fields-section-title-placeholder"),onchange:m.withAttr("value",this.updateSetting.bind(this,this.fieldsSectionTitle,"flagrow.mason.fields-section-title"))}),m(".helpText",o.a.translator.trans("flagrow-mason.admin.settings.fields-section-title-help"))]),m(".Form-group",[m("label",o.a.translator.trans("flagrow-mason.admin.settings.column-count")),Et.a.component({options:this.columnOptions,value:this.columnCount(),onchange:this.updateSetting.bind(this,this.columnCount,"flagrow.mason.column-count")})]),m(".Form-group",[m("label",_.a.component({state:this.labelsAsPlaceholders(),onchange:this.updateSetting.bind(this,this.labelsAsPlaceholders,"flagrow.mason.labels-as-placeholders"),children:o.a.translator.trans("flagrow-mason.admin.settings.labels-as-placeholders")})),m(".helpText",o.a.translator.trans("flagrow-mason.admin.settings.labels-as-placeholders-help"))]),m(".Form-group",[m("label",_.a.component({state:this.fieldsInHero(),onchange:this.updateSetting.bind(this,this.fieldsInHero,"flagrow.mason.fields-in-hero"),children:o.a.translator.trans("flagrow-mason.admin.settings.fields-in-hero")}))]),m(".Form-group",[m("label",_.a.component({state:this.hideEmptyFieldsSection(),onchange:this.updateSetting.bind(this,this.hideEmptyFieldsSection,"flagrow.mason.hide-empty-fields-section"),children:o.a.translator.trans("flagrow-mason.admin.settings.hide-empty-fields-section")})),m(".helpText",o.a.translator.trans("flagrow-mason.admin.settings.hide-empty-fields-section-help"))]),m(".Form-group",[m("label",_.a.component({state:this.tagsAsFields(),onchange:this.updateSetting.bind(this,this.tagsAsFields,"flagrow.mason.tags-as-fields"),children:o.a.translator.trans("flagrow-mason.admin.settings.tags-as-field")})),m(".helpText",o.a.translator.trans("flagrow-mason.admin.settings.tags-as-field-help"))]),this.tagsAsFields()?m(".Form-group",[m("label",o.a.translator.trans("flagrow-mason.admin.settings.tags-field-name")),m("input.FormControl",{value:this.tagsFieldName(),placeholder:o.a.translator.trans("flagrow-mason.admin.settings.tags-field-name-placeholder"),onchange:m.withAttr("value",this.updateSetting.bind(this,this.tagsFieldName,"flagrow.mason.tags-field-name"))})]):null])},n.updateSetting=function(t,e,n){var a;yt()(((a={})[e]=n,a)),t(n)},e}(h.a),Tt=function(t){function e(){return t.apply(this,arguments)||this}Object(f.a)(e,t);var n=e.prototype;return n.init=function(){o.a.request({method:"GET",url:o.a.forum.attribute("apiUrl")+"/flagrow/mason/fields"}).then(function(t){o.a.store.pushPayload(t),m.redraw()})},n.config=function(){var t=this;ht(".js-fields-container",{handle:".js-field-handle",items:".js-field-data"}).forEach(function(e){$(e).off("sortupdate").on("sortupdate",function(e){var n=e.detail.destination.items.map(function(t){return $(t).data("id")});t.updateSort(n)})})},n.view=function(){var t=o.a.store.all("flagrow-mason-field"),e=[];return Object(gt.a)(t).forEach(function(t){e.push(m(".js-field-data",{key:t.id(),"data-id":t.id()},vt.component({field:t})))}),m(".container",[m("h2",o.a.translator.trans("flagrow-mason.admin.titles.fields")),m(".Mason-Container",[m(".js-fields-container",e),vt.component({key:"new",field:null})]),m("h2",o.a.translator.trans("flagrow-mason.admin.titles.settings")),xt.component()])},n.updateSort=function(t){o.a.request({method:"POST",url:o.a.forum.attribute("apiUrl")+"/flagrow/mason/fields/order",data:{sort:t}}).then(function(t){o.a.store.pushPayload(t),m.redraw()})},e}(h.a),At=n(10),Ft=n.n(At),St=n(26),Mt=n.n(St);o.a.initializers.add("flagrow-mason",function(t){t.store.models["flagrow-mason-field"]=i.a,t.store.models["flagrow-mason-answer"]=r.a,o.a.routes["flagrow-mason-fields"]={path:"/mason",component:Tt.component()},o.a.extensionSettings["flagrow-mason"]=function(){return m.route(o.a.route("flagrow-mason-fields"))},Object(s.extend)(d.a.prototype,"items",function(t){t.add("flagrow-mason-fields",c.a.component({href:o.a.route("flagrow-mason-fields"),icon:"fas fa-dungeon",children:"Mason",description:o.a.translator.trans("flagrow-mason.admin.menu.description")}))}),Object(s.extend)(Mt.a.prototype,"permissionItems",function(t){var e=new Ft.a;e.add("see-own-fields",{icon:"fas fa-eye",label:o.a.translator.trans("flagrow-mason.admin.permissions.see-own-fields"),permission:"flagrow.mason.see-own-fields"}),e.add("see-other-fields",{icon:"fas fa-eye",label:o.a.translator.trans("flagrow-mason.admin.permissions.see-other-fields"),permission:"flagrow.mason.see-other-fields",allowGuest:!0}),e.add("fill-fields",{icon:"fas fa-tasks",label:o.a.translator.trans("flagrow-mason.admin.permissions.fill-fields"),permission:"flagrow.mason.fill-fields"}),e.add("update-own-fields",{icon:"fas fa-edit",label:o.a.translator.trans("flagrow-mason.admin.permissions.update-own-fields"),permission:"flagrow.mason.update-own-fields"}),e.add("update-other-fields",{icon:"fas fa-edit",label:o.a.translator.trans("flagrow-mason.admin.permissions.update-other-fields"),permission:"flagrow.mason.update-other-fields",allowGuest:!0}),e.add("skip-required-fields",{icon:"fas fa-forward",label:o.a.translator.trans("flagrow-mason.admin.permissions.skip-required-fields"),permission:"flagrow.mason.skip-required-fields"}),t.add("flagrow-mason",{label:o.a.translator.trans("flagrow-mason.admin.permissions.mason-heading"),children:e.toArray()})})})}]);
//# sourceMappingURL=admin.js.map