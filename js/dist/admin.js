module.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=27)}([function(t,e){t.exports=flarum.core.compat.app},function(t,e){t.exports=flarum.core.compat.Model},function(t,e,n){"use strict";function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)}n.d(e,"a",(function(){return a}))},function(t,e){t.exports=flarum.core.compat.Component},function(t,e){t.exports=flarum.core.compat["helpers/icon"]},function(t,e){t.exports=flarum.core.compat["components/Button"]},function(t,e,n){"use strict";e.a=function(t,e){return void 0===e&&(e="sort"),t.sort((function(t,n){return t[e]()-n[e]()}))}},,function(t,e){t.exports=flarum.core.compat["components/Switch"]},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n(2),a=n(1),r=n.n(a),i=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))||this).content=r.a.attribute("content"),e.is_suggested=r.a.attribute("is_suggested"),e.sort=r.a.attribute("sort"),e.field=r.a.hasOne("field"),e}return Object(o.a)(e,t),e.prototype.apiEndpoint=function(){return"/fof/mason/answers"+(this.exists?"/"+this.data.id:"")},e}(r.a)},function(t,e){t.exports=flarum.core.compat["utils/computed"]},,function(t,e){t.exports=flarum.core.compat["utils/extractText"]},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var o=n(2),a=n(1),r=n.n(a),i=n(10),s=n.n(i),l=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))||this).name=r.a.attribute("name"),e.description=r.a.attribute("description"),e.min_answers_count=r.a.attribute("min_answers_count"),e.max_answers_count=r.a.attribute("max_answers_count"),e.show_when_empty=r.a.attribute("show_when_empty"),e.user_values_allowed=r.a.attribute("user_values_allowed"),e.validation=r.a.attribute("validation"),e.icon=r.a.attribute("icon"),e.sort=r.a.attribute("sort"),e.deleted_at=r.a.attribute("deleted_at",r.a.transformDate),e.all_answers=r.a.hasMany("all_answers"),e.suggested_answers=r.a.hasMany("suggested_answers"),e.required=s()("min_answers_count",(function(t){return t>0})),e.multiple=s()("max_answers_count",(function(t){return t>1})),e}return Object(o.a)(e,t),e.prototype.apiEndpoint=function(){return"/fof/mason/fields"+(this.exists?"/"+this.data.id:"")},e}(r.a)},,,,,,,,,,function(t,e){t.exports=flarum.core.compat["components/ExtensionPage"]},function(t,e){t.exports=flarum.core.compat["utils/saveSettings"]},function(t,e){t.exports=flarum.core.compat["components/Select"]},,function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o),r=n(9),i=n(13),s=n(2);function l(t,e,n){if(void 0===n)return t&&t.h5s&&t.h5s.data&&t.h5s.data[e];t.h5s=t.h5s||{},t.h5s.data=t.h5s.data||{},t.h5s.data[e]=n}var d=function(t,e){if(!(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array))throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.");return"string"!=typeof e?Array.from(t):Array.from(t).filter((function(t){return 1===t.nodeType&&t.matches(e)}))},f=new Map,c=function(){function t(){this._config=new Map,this._placeholder=void 0,this._data=new Map}return Object.defineProperty(t.prototype,"config",{get:function(){var t={};return this._config.forEach((function(e,n){t[n]=e})),t},set:function(t){if("object"!=typeof t)throw new Error("You must provide a valid configuration object to the config setter.");var e=Object.assign({},t);this._config=new Map(Object.entries(e))},enumerable:!1,configurable:!0}),t.prototype.setConfig=function(t,e){if(!this._config.has(t))throw new Error("Trying to set invalid configuration item: "+t);this._config.set(t,e)},t.prototype.getConfig=function(t){if(!this._config.has(t))throw new Error("Invalid configuration item requested: "+t);return this._config.get(t)},Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._placeholder},set:function(t){if(!(t instanceof HTMLElement)&&null!==t)throw new Error("A placeholder must be an html element or null.");this._placeholder=t},enumerable:!1,configurable:!0}),t.prototype.setData=function(t,e){if("string"!=typeof t)throw new Error("The key must be a string.");this._data.set(t,e)},t.prototype.getData=function(t){if("string"!=typeof t)throw new Error("The key must be a string.");return this._data.get(t)},t.prototype.deleteData=function(t){if("string"!=typeof t)throw new Error("The key must be a string.");return this._data.delete(t)},t}(),u=function(t){if(!(t instanceof HTMLElement))throw new Error("Please provide a sortable to the store function.");return f.has(t)||f.set(t,new c),f.get(t)};function p(t,e,n){if(t instanceof Array)for(var o=0;o<t.length;++o)p(t[o],e,n);else t.addEventListener(e,n),u(t).setData("event"+e,n)}function h(t,e){if(t instanceof Array)for(var n=0;n<t.length;++n)h(t[n],e);else t.removeEventListener(e,u(t).getData("event"+e)),u(t).deleteData("event"+e)}function g(t,e,n){if(t instanceof Array)for(var o=0;o<t.length;++o)g(t[o],e,n);else t.setAttribute(e,n)}function v(t,e){if(t instanceof Array)for(var n=0;n<t.length;++n)v(t[n],e);else t.removeAttribute(e)}var w=function(t){if(!t.parentElement||0===t.getClientRects().length)throw new Error("target element must be part of the dom");var e=t.getClientRects()[0];return{left:e.left+window.pageXOffset,right:e.right+window.pageXOffset,top:e.top+window.pageYOffset,bottom:e.bottom+window.pageYOffset}},b=function(t,e){if(!(t instanceof HTMLElement&&(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array)))throw new Error("You must provide an element and a list of elements.");return Array.from(e).indexOf(t)},y=function(t){if(!(t instanceof HTMLElement))throw new Error("Element is not a node element.");return null!==t.parentNode},E=function(t,e,n){if(!(t instanceof HTMLElement&&t.parentElement instanceof HTMLElement))throw new Error("target and element must be a node");t.parentElement.insertBefore(e,"before"===n?t:t.nextElementSibling)},_=function(t,e){return E(t,e,"after")},x=function(t){if(!(t instanceof HTMLElement))throw new Error("You must provide a valid dom element");var e=window.getComputedStyle(t);return"border-box"===e.getPropertyValue("box-sizing")?parseInt(e.getPropertyValue("height"),10):["height","padding-top","padding-bottom"].map((function(t){var n=parseInt(e.getPropertyValue(t),10);return isNaN(n)?0:n})).reduce((function(t,e){return t+e}))},T=function(t){if(!(t instanceof HTMLElement))throw new Error("You must provide a valid dom element");var e=window.getComputedStyle(t);return["width","padding-left","padding-right"].map((function(t){var n=parseInt(e.getPropertyValue(t),10);return isNaN(n)?0:n})).reduce((function(t,e){return t+e}))},C=function(t,e){if(!(t instanceof Array))throw new Error("You must provide a Array of HTMLElements to be filtered.");return"string"!=typeof e?t:t.filter((function(t){return t.querySelector(e)instanceof HTMLElement||t.shadowRoot&&t.shadowRoot.querySelector(e)instanceof HTMLElement})).map((function(t){return t.querySelector(e)||t.shadowRoot&&t.shadowRoot.querySelector(e)}))},S=function(t){return t.composedPath&&t.composedPath()[0]||t.target},F=function(t,e,n){return{element:t,posX:n.pageX-e.left,posY:n.pageY-e.top}},A=function(t,e){if(!0===t.isSortable){var n=u(t).getConfig("acceptFrom");if(null!==n&&!1!==n&&"string"!=typeof n)throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==n)return!1!==n&&n.split(",").filter((function(t){return t.length>0&&e.matches(t)})).length>0;if(t===e)return!0;if(void 0!==u(t).getConfig("connectWith")&&null!==u(t).getConfig("connectWith"))return u(t).getConfig("connectWith")===u(e).getConfig("connectWith")}return!1},M={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,dropTargetContainerClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"};var L,O,P,j,H,B,I,D,k,N=function(t,e){if("string"==typeof u(t).getConfig("hoverClass")){var n=u(t).getConfig("hoverClass").split(" ");!0===e?(p(t,"mousemove",function(t,e){var n=this;if(void 0===e&&(e=250),"function"!=typeof t)throw new Error("You must provide a function as the first argument for throttle.");if("number"!=typeof e)throw new Error("You must provide a number as the second argument for throttle.");var o=null;return function(){for(var a=[],r=0;r<arguments.length;r++)a[r]=arguments[r];var i=Date.now();(null===o||i-o>=e)&&(o=i,t.apply(n,a))}}((function(e){0===e.buttons&&d(t.children,u(t).getConfig("items")).forEach((function(t){var o,a;t!==e.target?(o=t.classList).remove.apply(o,n):(a=t.classList).add.apply(a,n)}))}),u(t).getConfig("throttleTime"))),p(t,"mouseleave",(function(){d(t.children,u(t).getConfig("items")).forEach((function(t){var e;(e=t.classList).remove.apply(e,n)}))}))):(h(t,"mousemove"),h(t,"mouseleave"))}},Y=function(t){h(t,"dragstart"),h(t,"dragend"),h(t,"dragover"),h(t,"dragenter"),h(t,"drop"),h(t,"mouseenter"),h(t,"mouseleave")},q=function(t,e){t&&h(t,"dragleave"),e&&e!==t&&h(e,"dragleave")},z=function(t){var e;(e=t).h5s&&delete e.h5s.data,v(t,"aria-dropeffect")},U=function(t){v(t,"aria-grabbed"),v(t,"aria-copied"),v(t,"draggable"),v(t,"role")};function W(t,e){if(e.composedPath)return e.composedPath().find((function(t){return t.isSortable}));for(;!0!==t.isSortable;)t=t.parentElement;return t}function R(t,e){var n=l(t,"opts"),o=d(t.children,n.items).filter((function(t){return t.contains(e)||t.shadowRoot&&t.shadowRoot.contains(e)}));return o.length>0?o[0]:e}var X=function(t){var e=l(t,"opts"),n=d(t.children,e.items),o=C(n,e.handle);(g(t,"aria-dropeffect","move"),l(t,"_disabled","false"),g(o,"draggable","true"),!1===e.disableIEFix)&&("function"==typeof(document||window.document).createElement("span").dragDrop&&p(o,"mousedown",(function(){if(-1!==n.indexOf(this))this.dragDrop();else{for(var t=this.parentElement;-1===n.indexOf(t);)t=t.parentElement;t.dragDrop()}})))};function G(t,e){var n=String(e);return e=e||{},"string"==typeof t&&(t=document.querySelectorAll(t)),t instanceof HTMLElement&&(t=[t]),t=Array.prototype.slice.call(t),/serialize/.test(n)?t.map((function(t){var e=l(t,"opts");return function(t,e,n){if(void 0===e&&(e=function(t,e){return t}),void 0===n&&(n=function(t){return t}),!(t instanceof HTMLElement)||!0==!t.isSortable)throw new Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof e||"function"!=typeof n)throw new Error("You need to provide a valid serializer for items and the container.");var o=l(t,"opts").items,a=d(t.children,o),r=a.map((function(e){return{parent:t,node:e,html:e.outerHTML,index:b(e,a)}}));return{container:n({node:t,itemCount:r.length}),items:r.map((function(n){return e(n,t)}))}}(t,e.itemSerializer,e.containerSerializer)})):(t.forEach((function(t){if(/enable|disable|destroy/.test(n))return G[n](t);["connectWith","disableIEFix"].forEach((function(t){Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+t+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')})),e=Object.assign({},M,u(t).config,e),u(t).config=e,l(t,"opts",e),t.isSortable=!0,function(t){var e=l(t,"opts"),n=d(t.children,e.items),o=C(n,e.handle);l(t,"_disabled","false"),Y(n),q(j,D),h(o,"mousedown"),h(t,"dragover"),h(t,"dragenter"),h(t,"drop")}(t);var o,a=d(t.children,e.items);if(null!==e.placeholder&&void 0!==e.placeholder){var r=document.createElement(t.tagName);e.placeholder instanceof HTMLElement?r.appendChild(e.placeholder):r.innerHTML=e.placeholder,o=r.children[0]}u(t).placeholder=function(t,e,n){var o;if(void 0===n&&(n="sortable-placeholder"),!(t instanceof HTMLElement))throw new Error("You must provide a valid element as a sortable.");if(!(e instanceof HTMLElement)&&void 0!==e)throw new Error("You must provide a valid element as a placeholder or set ot to undefined.");return void 0===e&&(["UL","OL"].includes(t.tagName)?e=document.createElement("li"):["TABLE","TBODY"].includes(t.tagName)?(e=document.createElement("tr")).innerHTML='<td colspan="100"></td>':e=document.createElement("div")),"string"==typeof n&&(o=e.classList).add.apply(o,n.split(" ")),e}(t,o,e.placeholderClass),l(t,"items",e.items),e.acceptFrom?l(t,"acceptFrom",e.acceptFrom):e.connectWith&&l(t,"connectWith",e.connectWith),X(t),g(a,"role","option"),g(a,"aria-grabbed","false"),N(t,!0),p(t,"dragstart",(function(t){var n=S(t);if(!0!==n.isSortable&&(t.stopImmediatePropagation(),(!e.handle||n.matches(e.handle))&&"false"!==n.getAttribute("draggable"))){var o=W(n,t),a=R(o,n);I=d(o.children,e.items),H=I.indexOf(a),B=b(a,o.children),j=o,function(t,e,n){if(!(t instanceof Event))throw new Error("setDragImage requires a DragEvent as the first argument.");if(!(e instanceof HTMLElement))throw new Error("setDragImage requires the dragged element as the second argument.");if(n||(n=F),t.dataTransfer&&t.dataTransfer.setDragImage){var o=n(e,w(e),t);if(!(o.element instanceof HTMLElement)||"number"!=typeof o.posX||"number"!=typeof o.posY)throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setData("text/plain",S(t).id),t.dataTransfer.setDragImage(o.element,o.posX,o.posY)}}(t,a,e.customDragImage),O=x(a),P=T(a),a.classList.add(e.draggingClass),L=function(t,e){var n=t;return!0===u(e).getConfig("copy")&&(g(n=t.cloneNode(!0),"aria-copied","true"),t.parentElement.appendChild(n),n.style.display="none",n.oldDisplay=t.style.display),n}(a,o),g(L,"aria-grabbed","true"),o.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:B,index:H,container:j},item:L,originalTarget:n}}))}})),p(t,"dragenter",(function(n){var o=S(n),a=W(o,n);a&&a!==D&&(k=d(a.children,l(a,"items")).filter((function(e){return e!==u(t).placeholder})),e.dropTargetContainerClass&&a.classList.add(e.dropTargetContainerClass),a.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:B,index:H,container:j},destination:{container:a,itemsBeforeUpdate:k},item:L,originalTarget:o}})),p(a,"dragleave",(function(t){var n=t.relatedTarget||t.fromElement;t.currentTarget.contains(n)||(e.dropTargetContainerClass&&a.classList.remove(e.dropTargetContainerClass),a.dispatchEvent(new CustomEvent("sortleave",{detail:{origin:{elementIndex:B,index:H,container:a},item:L,originalTarget:o}})))}))),D=a})),p(t,"dragend",(function(n){if(L){L.classList.remove(e.draggingClass),g(L,"aria-grabbed","false"),"true"===L.getAttribute("aria-copied")&&"true"!==l(L,"dropped")&&L.remove(),L.style.display=L.oldDisplay,delete L.oldDisplay;var o=Array.from(f.values()).map((function(t){return t.placeholder})).filter((function(t){return t instanceof HTMLElement})).filter(y)[0];o&&o.remove(),t.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:B,index:H,container:j},item:L}})),D=null,L=null,O=null,P=null}})),p(t,"drop",(function(n){if(A(t,L.parentElement)){n.preventDefault(),n.stopPropagation(),l(L,"dropped","true");var o=Array.from(f.values()).map((function(t){return t.placeholder})).filter((function(t){return t instanceof HTMLElement})).filter(y)[0];_(o,L),o.remove(),t.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:B,index:H,container:j},item:L}}));var a=u(t).placeholder,r=d(j.children,e.items).filter((function(t){return t!==a})),i=!0===this.isSortable?this:this.parentElement,s=d(i.children,l(i,"items")).filter((function(t){return t!==a})),c=b(L,Array.from(L.parentElement.children).filter((function(t){return t!==a}))),m=b(L,s);e.dropTargetContainerClass&&i.classList.remove(e.dropTargetContainerClass),B===c&&j===i||t.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:B,index:H,container:j,itemsBeforeUpdate:I,items:r},destination:{index:m,elementIndex:c,container:i,itemsBeforeUpdate:k,items:s},item:L}}))}}));var i,s,c,m=(i=function(t,n,o,a){if(L)if(e.forcePlaceholderSize&&(u(t).placeholder.style.height=O+"px",u(t).placeholder.style.width=P+"px"),Array.from(t.children).indexOf(n)>-1){var r=x(n),i=T(n),s=b(u(t).placeholder,n.parentElement.children),l=b(n,n.parentElement.children);if(r>O||i>P){var c=r-O,m=i-P,p=w(n).top,h=w(n).left;if(s<l&&("vertical"===e.orientation&&a<p||"horizontal"===e.orientation&&o<h))return;if(s>l&&("vertical"===e.orientation&&a>p+r-c||"horizontal"===e.orientation&&o>h+i-m))return}void 0===L.oldDisplay&&(L.oldDisplay=L.style.display),"none"!==L.style.display&&(L.style.display="none");var g=!1;try{var v=w(n).top+n.offsetHeight/2,y=w(n).left+n.offsetWidth/2;g="vertical"===e.orientation&&a>=v||"horizontal"===e.orientation&&o>=y}catch(t){g=s<l}g?_(n,u(t).placeholder):function(t,e){E(t,e,"before")}(n,u(t).placeholder),Array.from(f.values()).filter((function(t){return void 0!==t.placeholder})).forEach((function(e){e.placeholder!==u(t).placeholder&&e.placeholder.remove()}))}else{var C=Array.from(f.values()).filter((function(t){return void 0!==t.placeholder})).map((function(t){return t.placeholder}));-1!==C.indexOf(n)||t!==n||d(n.children,e.items).length||(C.forEach((function(t){return t.remove()})),n.appendChild(u(t).placeholder))}},void 0===(s=e.debounce)&&(s=0),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];clearTimeout(c),c=setTimeout((function(){i.apply(void 0,t)}),s)}),v=function(t){var e=t.target,n=!0===e.isSortable?e:W(e,t);if(e=R(n,e),L&&A(n,L.parentElement)&&"true"!==l(n,"_disabled")){var o=l(n,"opts");parseInt(o.maxItems)&&d(n.children,l(n,"items")).length>=parseInt(o.maxItems)&&L.parentElement!==n||(t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect=!0===u(n).getConfig("copy")?"copy":"move",m(n,e,t.pageX,t.pageY))}};p(a.concat(t),"dragover",v),p(a.concat(t),"dragenter",v)})),t)}G.destroy=function(t){!function(t){var e=l(t,"opts")||{},n=d(t.children,e.items),o=C(n,e.handle);h(t,"dragover"),h(t,"dragenter"),h(t,"dragstart"),h(t,"dragend"),h(t,"drop"),z(t),h(o,"mousedown"),Y(n),U(n),q(j,D),t.isSortable=!1}(t)},G.enable=function(t){X(t)},G.disable=function(t){!function(t){var e=l(t,"opts"),n=d(t.children,e.items),o=C(n,e.handle);g(t,"aria-dropeffect","none"),l(t,"_disabled","true"),g(o,"draggable","false"),h(o,"mousedown")}(t)},G.__testing={_data:l,_removeItemEvents:Y,_removeItemData:U,_removeSortableData:z,_removeContainerEvents:q};var V=G,J=n(23),K=n.n(J),Q=n(4),Z=n.n(Q),tt=n(12),et=n.n(tt),nt=n(3),ot=n.n(nt),at=n(5),rt=n.n(at),it=n(8),st=n.n(it),lt=function(t){function e(){return t.apply(this,arguments)||this}Object(s.a)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.answer=this.attrs.answer,this.dirty=!1,this.processing=!1},n.view=function(){var t=this;return m(".Mason-Box",[this.answer.is_suggested()?[m("span.fas.fa-arrows-alt.Mason-Box--handle.js-answer-handle")," "]:null,m("span",{onclick:function(){var e=prompt(et()(a.a.translator.trans("fof-mason.admin.buttons.edit-answer-prompt")),t.answer.content());e&&t.updateAttribute("content",e)},title:et()(a.a.translator.trans("fof-mason.admin.buttons.edit-answer"))},[this.answer.content()," ",Z()("fas fa-pen")]),st.a.component({state:this.answer.is_suggested(),onchange:function(e){t.updateAttribute("is_suggested",e),t.saveAnswer()}},a.a.translator.trans("fof-mason.admin.fields.is_suggested")),m(".ButtonGroup",[rt.a.component({className:"Button Button--primary",loading:this.processing,disabled:!this.readyToSave(),onclick:this.saveAnswer.bind(this)},a.a.translator.trans("fof-mason.admin.buttons.save-answer")),rt.a.component({className:"Button Button--danger",loading:this.processing,onclick:this.deleteAnswer.bind(this)},a.a.translator.trans("fof-mason.admin.buttons.delete-answer"))])])},n.updateAttribute=function(t,e){var n;this.answer.pushAttributes(((n={})[t]=e,n)),this.dirty=!0},n.readyToSave=function(){return this.dirty},n.saveAnswer=function(){var t=this;this.processing=!0,this.answer.save(this.answer.data.attributes).then((function(){t.processing=!1,t.dirty=!1,m.redraw()})).catch((function(e){throw t.processing=!1,e}))},n.deleteAnswer=function(){var t=this;confirm(et()(a.a.translator.trans("fof-mason.admin.messages.delete-answer-confirmation",{content:this.answer.content()})))&&(this.processing=!0,this.answer.delete().then((function(){t.processing=!1,m.redraw()})).catch((function(e){throw t.processing=!1,e})))},e}(ot.a),dt=n(6),ft=function(t){function e(){return t.apply(this,arguments)||this}Object(s.a)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.field=this.attrs.field,this.processing=!1,this.new_content="",this.showUserAnswers=!1},n.configSortable=function(){var t=this,e=this.element.querySelector(".js-answers-container");e&&V(e,{handle:".js-answer-handle"})[0].addEventListener("sortupdate",(function(){var e=t.$(".js-answer-data").map((function(){return $(this).data("id")})).get();t.updateSort(e)}))},n.oncreate=function(e){t.prototype.oncreate.call(this,e),this.configSortable()},n.onupdate=function(){this.configSortable()},n.view=function(){var t=this;if(!this.field.exists)return m("div",a.a.translator.trans("fof-mason.admin.fields.save-field-for-answers"));var e=[],n=[];return this.field.all_answers().forEach((function(t){void 0!==t&&(t.is_suggested()?e.push(t):n.push(t))})),m("div",[m(".Mason-Container.js-answers-container",Object(dt.a)(e).map((function(t){return m(".js-answer-data",{key:t.id(),"data-id":t.id()},lt.component({answer:t}))}))),n.length?[m(".Button.Button--block.Mason-Box-Header",{onclick:function(){t.showUserAnswers=!t.showUserAnswers}},[m(".Mason-Box-Header-Title",a.a.translator.trans("fof-mason.admin.buttons.show-user-answers",{count:n.length})),m("div",[Z()("fas fa-chevron-"+(this.showUserAnswers?"up":"down"))])]),this.showUserAnswers?m(".Mason-Container",Object(dt.a)(n,"content").map((function(t){return m("div",{key:t.id()},lt.component({answer:t}))}))):null]:null,m(".Form-group",[m("label",a.a.translator.trans("fof-mason.admin.fields.new-answer")),m("input.FormControl",{value:this.new_content,oninput:function(e){t.new_content=e.target.value},placeholder:a.a.translator.trans("fof-mason.admin.fields.new-answer-placeholder")})]),m(".Form-group",[rt.a.component({className:"Button Button--primary",loading:this.processing,disabled:!this.new_content,onclick:this.saveField.bind(this)},a.a.translator.trans("fof-mason.admin.buttons.add-answer"))])])},n.saveField=function(){var t=this;this.processing=!0,a.a.request({method:"POST",url:a.a.forum.attribute("apiUrl")+this.field.apiEndpoint()+"/answers",body:{data:{attributes:{content:this.new_content,is_suggested:!0}}}}).then((function(e){a.a.store.pushPayload(e),t.new_content="",t.processing=!1,m.redraw()}))},n.updateSort=function(t){a.a.request({method:"POST",url:a.a.forum.attribute("apiUrl")+this.field.apiEndpoint()+"/answers/order",body:{sort:t}}).then((function(t){a.a.store.pushPayload(t),m.redraw()}))},e}(ot.a),ct=function(t){function e(){return t.apply(this,arguments)||this}Object(s.a)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.field=this.attrs.field,this.dirty=!1,this.processing=!1,this.toggleFields=!1,null===this.field&&this.initNewField()},n.initNewField=function(){this.field=a.a.store.createRecord("mason-fields",{attributes:{name:"",description:"",min_answers_count:0,max_answers_count:1,user_values_allowed:!1,show_when_empty:!1,validation:"",icon:""}})},n.boxTitle=function(){return this.field.exists?this.field.name():a.a.translator.trans("fof-mason.admin.buttons.new-field")},n.view=function(){var t=this;return m(".Mason-Box",[this.field.exists?m("span.fas.fa-arrows-alt.Mason-Box--handle.js-field-handle"):null,m(".Button.Button--block.Mason-Box-Header",{onclick:function(){t.toggleFields=!t.toggleFields}},[m(".Mason-Box-Header-Title",this.boxTitle()),m("div",[this.field.exists?[a.a.translator.trans("fof-mason.admin.buttons.edit-field")," "]:null,Z()("fas fa-chevron-"+(this.toggleFields?"up":"down"))])]),this.toggleFields?this.viewFields():null])},n.viewFields=function(){var t=this;return[m(".Mason-Box--row",[m(".Mason-Box--column",[m("h4",a.a.translator.trans("fof-mason.admin.titles.field-settings")),m(".Form-group",[m("label",a.a.translator.trans("fof-mason.admin.fields.name")),m("input.FormControl",{value:this.field.name(),oninput:function(e){t.updateAttribute("name",e.target.value)}}),m(".helpText",a.a.translator.trans("fof-mason.admin.fields.name-help"))]),m(".Form-group",[m("label",a.a.translator.trans("fof-mason.admin.fields.description")),m("input.FormControl",{value:this.field.description(),oninput:function(e){t.updateAttribute("description",e.target.value)}}),m(".helpText",a.a.translator.trans("fof-mason.admin.fields.description-help"))]),m(".Form-group",[m("label",[st.a.component({state:1===this.field.min_answers_count(),onchange:function(e){t.updateAttribute("min_answers_count",e?1:0)}},a.a.translator.trans("fof-mason.admin.fields.required"))])]),m(".Form-group",[m("label",[st.a.component({state:this.field.show_when_empty(),onchange:this.updateAttribute.bind(this,"show_when_empty")},a.a.translator.trans("fof-mason.admin.fields.show_when_empty"))]),m(".helpText",a.a.translator.trans("fof-mason.admin.fields.show_when_empty-help"))]),m(".Form-group",[m("label",[st.a.component({state:this.field.user_values_allowed(),onchange:this.updateAttribute.bind(this,"user_values_allowed")},a.a.translator.trans("fof-mason.admin.fields.user_values_allowed"))]),m(".helpText",a.a.translator.trans("fof-mason.admin.fields.user_values_allowed-help"))]),m(".Form-group",[m("label",a.a.translator.trans("fof-mason.admin.fields.validation")),m("input.FormControl",{disabled:!this.field.user_values_allowed(),placeholder:this.field.user_values_allowed()?"":a.a.translator.trans("fof-mason.admin.fields.enable-user-values-for-validation"),value:this.field.validation(),oninput:function(e){t.updateAttribute("validation",e.target.value)}}),m(".helpText",a.a.translator.trans("fof-mason.admin.fields.validation-help",{a:m("a",{href:"https://laravel.com/docs/6.x/validation#available-validation-rules",target:"_blank"})}))]),m(".Form-group",[m("label",[a.a.translator.trans("fof-mason.admin.fields.icon"),this.iconPreview(this.field.icon())]),m("input.FormControl",{value:this.field.icon(),oninput:function(e){t.updateAttribute("icon",e.target.value)}}),m(".helpText",a.a.translator.trans("fof-mason.admin.fields.icon-help",{a:m("a",{href:"https://fontawesome.com/icons?m=free",target:"_blank"})}))])]),m(".Mason-Box--column",[m("h4",a.a.translator.trans("fof-mason.admin.titles.field-answers")),m(".Form-group",ft.component({field:this.field}))])]),m(".ButtonGroup",[rt.a.component({className:"Button Button--primary",loading:this.processing,disabled:!this.readyToSave(),onclick:this.saveField.bind(this)},a.a.translator.trans("fof-mason.admin.buttons."+(this.field.exists?"save":"add")+"-field")),this.field.exists?rt.a.component({className:"Button Button--danger",loading:this.processing,onclick:this.deleteField.bind(this)},a.a.translator.trans("fof-mason.admin.buttons.delete-field")):""])]},n.updateAttribute=function(t,e){var n;this.field.pushAttributes(((n={})[t]=e,n)),this.dirty=!0},n.readyToSave=function(){return this.dirty},n.saveField=function(){var t=this;this.processing=!0;var e=!this.field.exists;this.field.save(this.field.data.attributes).then((function(){e&&(t.initNewField(),t.toggleFields=!1),t.processing=!1,t.dirty=!1,m.redraw()})).catch((function(e){throw t.processing=!1,e}))},n.deleteField=function(){var t=this;confirm(et()(a.a.translator.trans("fof-mason.admin.messages.delete-field-confirmation",{name:this.field.name()})))&&(this.processing=!0,this.field.delete().then((function(){t.processing=!1,m.redraw()})).catch((function(e){throw t.processing=!1,e})))},n.iconPreview=function(t){return t?[" (",a.a.translator.trans("fof-mason.admin.fields.icon-preview",{preview:Z()(t)}),")"]:""},e}(ot.a),ut=n(24),mt=n.n(ut),pt=n(25),ht=n.n(pt),gt=function(t){function e(){return t.apply(this,arguments)||this}Object(s.a)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.fieldsSectionTitle=a.a.data.settings["fof-mason.fields-section-title"]||"",this.columnCount=a.a.data.settings["fof-mason.column-count"]||1,this.labelsAsPlaceholders=a.a.data.settings["fof-mason.labels-as-placeholders"]>0,this.fieldsInHero=a.a.data.settings["fof-mason.fields-in-hero"]>0,this.hideEmptyFieldsSection=a.a.data.settings["fof-mason.hide-empty-fields-section"]>0,this.tagsAsFields=a.a.data.settings["fof-mason.tags-as-fields"]>0,this.tagsFieldName=a.a.data.settings["fof-mason.tags-field-name"]||"",this.columnOptions={};for(var n=1;n<=3;n++)this.columnOptions[n]=a.a.translator.trans("fof-mason.admin.settings.n-columns",{count:n})},n.view=function(){var t=this;return m(".Mason-Container",[m(".Form-group",[m("label",a.a.translator.trans("fof-mason.admin.settings.fields-section-title")),m("input.FormControl",{value:this.fieldsSectionTitle,placeholder:a.a.translator.trans("fof-mason.admin.settings.fields-section-title-placeholder"),onchange:function(e){t.updateSetting("fieldsSectionTitle","fof-mason.fields-section-title",e.target.value)}}),m(".helpText",a.a.translator.trans("fof-mason.admin.settings.fields-section-title-help"))]),m(".Form-group",[m("label",a.a.translator.trans("fof-mason.admin.settings.column-count")),ht.a.component({options:this.columnOptions,value:this.columnCount,onchange:this.updateSetting.bind(this,"columnCount","fof-mason.column-count")})]),m(".Form-group",[m("label",st.a.component({state:this.labelsAsPlaceholders,onchange:this.updateSetting.bind(this,"labelsAsPlaceholders","fof-mason.labels-as-placeholders")},a.a.translator.trans("fof-mason.admin.settings.labels-as-placeholders"))),m(".helpText",a.a.translator.trans("fof-mason.admin.settings.labels-as-placeholders-help"))]),m(".Form-group",[m("label",st.a.component({state:this.fieldsInHero,onchange:this.updateSetting.bind(this,"fieldsInHero","fof-mason.fields-in-hero")},a.a.translator.trans("fof-mason.admin.settings.fields-in-hero")))]),m(".Form-group",[m("label",st.a.component({state:this.hideEmptyFieldsSection,onchange:this.updateSetting.bind(this,"hideEmptyFieldsSection","fof-mason.hide-empty-fields-section")},a.a.translator.trans("fof-mason.admin.settings.hide-empty-fields-section"))),m(".helpText",a.a.translator.trans("fof-mason.admin.settings.hide-empty-fields-section-help"))]),m(".Form-group",[m("label",st.a.component({state:this.tagsAsFields,onchange:this.updateSetting.bind(this,"tagsAsFields","fof-mason.tags-as-fields")},a.a.translator.trans("fof-mason.admin.settings.tags-as-field"))),m(".helpText",a.a.translator.trans("fof-mason.admin.settings.tags-as-field-help"))]),this.tagsAsFields?m(".Form-group",[m("label",a.a.translator.trans("fof-mason.admin.settings.tags-field-name")),m("input.FormControl",{value:this.tagsFieldName,placeholder:a.a.translator.trans("fof-mason.admin.settings.tags-field-name-placeholder"),onchange:function(e){t.updateSetting("tagsFieldName","fof-mason.tags-field-name",e.target.value)}})]):null])},n.updateSetting=function(t,e,n){var o;mt()(((o={})[e]=n,o)),this[t]=n},e}(ot.a),vt=function(t){function e(){return t.apply(this,arguments)||this}Object(s.a)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),a.a.request({method:"GET",url:a.a.forum.attribute("apiUrl")+"/fof/mason/fields"}).then((function(t){a.a.store.pushPayload(t),m.redraw()}))},n.configSortable=function(){var t=this;V(this.element.querySelector(".js-fields-container"),{handle:".js-field-handle"})[0].addEventListener("sortupdate",(function(){var e=t.$(".js-field-data").map((function(){return $(this).data("id")})).get();t.updateSort(e)}))},n.oncreate=function(e){t.prototype.oncreate.call(this,e),this.configSortable()},n.onupdate=function(){this.configSortable()},n.content=function(){var t=a.a.store.all("mason-fields"),e=[];return Object(dt.a)(t).forEach((function(t){e.push(m(".js-field-data",{key:t.id(),"data-id":t.id()},ct.component({field:t})))})),m(".ExtensionPage-settings",m(".container",[m("h2",a.a.translator.trans("fof-mason.admin.titles.fields")),m(".Mason-Container",[m(".js-fields-container",e),ct.component({field:null})]),m("h2",a.a.translator.trans("fof-mason.admin.titles.settings")),gt.component()]))},n.updateSort=function(t){a.a.request({method:"POST",url:a.a.forum.attribute("apiUrl")+"/fof/mason/fields/order",body:{sort:t}}).then((function(t){a.a.store.pushPayload(t),m.redraw()}))},e}(K.a);a.a.initializers.add("fof-mason",(function(){a.a.store.models["mason-fields"]=i.a,a.a.store.models["mason-answers"]=r.a,a.a.extensionData.for("fof-mason").registerPage(vt).registerPermission({icon:"fas fa-eye",label:a.a.translator.trans("fof-mason.admin.permissions.see-own-fields"),permission:"fof-mason.see-own-fields"},"view").registerPermission({icon:"fas fa-eye",label:a.a.translator.trans("fof-mason.admin.permissions.see-other-fields"),permission:"fof-mason.see-other-fields",allowGuest:!0},"view").registerPermission({icon:"fas fa-tasks",label:a.a.translator.trans("fof-mason.admin.permissions.fill-fields"),permission:"fof-mason.fill-fields"},"reply").registerPermission({icon:"fas fa-edit",label:a.a.translator.trans("fof-mason.admin.permissions.update-own-fields"),permission:"fof-mason.update-own-fields"},"reply").registerPermission({icon:"fas fa-edit",label:a.a.translator.trans("fof-mason.admin.permissions.update-other-fields"),permission:"fof-mason.update-other-fields",allowGuest:!0},"moderate").registerPermission({icon:"fas fa-forward",label:a.a.translator.trans("fof-mason.admin.permissions.skip-required-fields"),permission:"fof-mason.skip-required-fields"},"moderate")}))}]);
//# sourceMappingURL=admin.js.map